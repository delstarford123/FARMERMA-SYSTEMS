{% extends "base.html" %}

{% block content %}
{% set hero = get_site_content('home_hero') %}

<section class="hero-section text-center position-relative overflow-hidden" 
         style="background: linear-gradient(rgba(241, 248, 233, 0.9), rgba(241, 248, 233, 0.9)), 
                url('https://images.unsplash.com/photo-1625246333195-78d9c38ad449?auto=format&fit=crop&w=1920&q=80') center/cover;">
    
    <div class="container py-5">
        <span class="badge bg-success mb-3 px-3 py-2 fs-6 rounded-pill hero-badge">Data-Driven Agriculture</span>
        
        <h1 class="display-4 fw-bold text-dark mb-4">
            <span id="hero-typewriter"></span><span class="typewriter-cursor">|</span>
        </h1>
        
        <p class="lead mb-5 text-dark hero-lead" style="max-width: 800px; margin: 0 auto; font-weight: 500; opacity: 0;">
            {{ hero.body if hero else "We bridge the gap between farmers, markets, and policymakers through market intelligence, AI-driven insights, and inclusive empowerment programs." }}
        </p>
        
        <div class="d-flex justify-content-center gap-3 hero-btns" style="opacity: 0;">
            <a href="/pricing" class="btn btn-primary btn-lg px-5 fw-bold shadow-sm magnetic-btn">Subscribe to Market Data</a>
            <a href="/contact" class="btn btn-outline-dark btn-lg px-5 fw-bold bg-white magnetic-btn">Consult With Us</a>
        </div>

        {% if session.get('role') == 'admin' %}
        <div class="mt-4 admin-control" style="opacity: 0;">
            <a href="/admin/content" class="btn btn-sm btn-dark rounded-pill px-3 shadow-sm">
                <i class="bi bi-gear-fill me-1"></i> Edit Hero Content
            </a>
        </div>
        {% endif %}
    </div>
</section>

<section class="py-5 bg-white overflow-hidden">
    <div class="container py-4">
        <div class="row text-center mb-5 section-header" style="opacity: 0;">
            <div class="col-lg-8 mx-auto">
                <h2 class="fw-bold text-primary-green">Reducing Risk. Maximizing Profit.</h2>
                <p class="text-muted lead">Farmerman Systems provides the critical infrastructure needed to navigate volatile agricultural markets and build resilient rural livelihoods.</p>
            </div>
        </div>
        
        <div class="row g-4">
            <div class="col-md-4 feature-card" style="opacity: 0;">
                <div class="card h-100 shadow-sm border-0 bg-light">
                    <div class="card-body text-center p-4">
                        <div class="display-5 text-success mb-3"><i class="bi bi-graph-up-arrow"></i></div>
                        <h4 class="card-title fw-bold">Market Intelligence</h4>
                        <p class="card-text text-muted">Access live, verified dashboards tracking agricultural commodity prices and trends across regional markets.</p>
                    </div>
                </div>
            </div>
            <div class="col-md-4 feature-card" style="opacity: 0;">
                <div class="card h-100 shadow-sm border-0 bg-light">
                    <div class="card-body text-center p-4">
                        <div class="display-5 text-success mb-3"><i class="bi bi-people-fill"></i></div>
                        <h4 class="card-title fw-bold">Community Empowerment</h4>
                        <p class="card-text text-muted">Capacity-building programs dedicated to enhancing the participation of women and youth in agribusiness.</p>
                    </div>
                </div>
            </div>
            <div class="col-md-4 feature-card" style="opacity: 0;">
                <div class="card h-100 shadow-sm border-0 bg-light">
                    <div class="card-body text-center p-4">
                        <div class="display-5 text-success mb-3"><i class="bi bi-cpu-fill"></i></div>
                        <h4 class="card-title fw-bold">Digital Innovation & AI</h4>
                        <p class="card-text text-muted">Integrating emerging technologies and AI to create smart, predictive models for agricultural value chains.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
<div class="hero-section">
    {% set home_hero = get_site_content('home_hero') %}
    {% if home_hero %}
        <h1>{{ home_hero.title }}</h1>
        <p>{{ home_hero.body | safe }}</p>
    {% else %}
        <h1>Default Transforming African Agribusiness</h1>
        <p>Default mission statement text...</p>
    {% endif %}
</div>
<section class="py-5 bg-dark text-white text-center overflow-hidden footer-cta">
    <div class="container py-4">
        <h3 class="fw-bold mb-4 cta-title" style="opacity: 0;">Partnering for Sustainable Growth</h3>
        <p class="lead max-w-75 mx-auto mb-5 text-light cta-text" style="opacity: 0;">We work alongside government institutions, development agencies, NGOs, financial institutions, and private agribusinesses to design impact-driven solutions.</p>
        <a href="/about" class="btn btn-outline-light btn-lg px-4 cta-btn" style="opacity: 0;">Learn More About Our Founder & Vision</a>
    </div>
</section>

<style>
    .typewriter-cursor {
        display: inline-block;
        width: 3px;
        background-color: var(--primary-green);
        margin-left: 5px;
        animation: blink 0.8s infinite;
    }
    @keyframes blink { 50% { opacity: 0; } }
</style>
{% endblock %}

{% block extra_js %}
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollTrigger.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/TextPlugin.min.js"></script>

<script>
    gsap.registerPlugin(ScrollTrigger, TextPlugin);

    // 1. Elastic Snap (Badge)
    gsap.from(".hero-badge", {
        y: -100,
        opacity: 0,
        duration: 1.5,
        ease: "elastic.out(1, 0.3)"
    });

    // 2. Typewriter (CMS Title)
    const heroTitle = "{{ hero.title if hero else 'Transforming African Agribusiness Ecosystems' }}";
    gsap.to("#hero-typewriter", {
        text: heroTitle,
        duration: 2.5,
        delay: 0.5,
        ease: "none"
    });

    // 3. Sequential Entrances
    gsap.to(".hero-lead", { opacity: 1, y: -20, duration: 1, delay: 2.5, ease: "power2.out" });
    gsap.to(".hero-btns", { opacity: 1, y: -20, duration: 1, delay: 2.8, ease: "power2.out" });
    gsap.to(".admin-control", { opacity: 1, duration: 0.5, delay: 3.2 });

    // 4. Scroll Triggered Section Headers
    gsap.to(".section-header", {
        scrollTrigger: ".section-header",
        opacity: 1,
        y: -30,
        duration: 1,
        ease: "power2.out"
    });

    // 5. Cascade Feature Cards
    gsap.to(".feature-card", {
        scrollTrigger: {
            trigger: ".feature-card",
            start: "top 85%"
        },
        opacity: 1,
        y: -50,
        stagger: 0.2,
        duration: 0.8,
        ease: "power3.out"
    });

    // 6. Footer CTA Timeline
    const ctaTl = gsap.timeline({
        scrollTrigger: {
            trigger: ".footer-cta",
            start: "top 80%"
        }
    });
    ctaTl.to(".cta-title", { opacity: 1, x: 0, duration: 0.8 })
         .to(".cta-text", { opacity: 1, duration: 0.8 }, "-=0.4")
         .to(".cta-btn", { opacity: 1, scale: 1.1, duration: 0.5, ease: "back.out(1.7)" });

    // 7. Interactive Magnetic Buttons
    const btns = document.querySelectorAll(".magnetic-btn");
    btns.forEach(btn => {
        btn.addEventListener("mousemove", (e) => {
            const rect = btn.getBoundingClientRect();
            const x = e.clientX - rect.left - rect.width / 2;
            const y = e.clientY - rect.top - rect.height / 2;
            gsap.to(btn, { x: x * 0.3, y: y * 0.3, duration: 0.3 });
        });
        btn.addEventListener("mouseleave", () => {
            gsap.to(btn, { x: 0, y: 0, duration: 0.3 });
        });
    });
</script>
{% endblock %}